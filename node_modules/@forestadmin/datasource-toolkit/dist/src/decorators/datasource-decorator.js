"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const base_datasource_1 = __importDefault(require("../base-datasource"));
class DataSourceDecorator extends base_datasource_1.default {
    constructor(childDataSource, CollectionDecoratorCtor) {
        super();
        this.addCollectionToChildDataSource = childDataSource.addCollection.bind(childDataSource);
        Reflect.defineProperty(childDataSource, 'addCollection', {
            value: this.addCollectionObserver.bind(this),
        });
        this.childDataSource = childDataSource;
        this.CollectionDecoratorCtor = CollectionDecoratorCtor;
        this.childDataSource.collections.forEach(collection => this.addCollection(new this.CollectionDecoratorCtor(collection, this)));
    }
    get schema() {
        return this.childDataSource.schema;
    }
    renderChart(caller, name) {
        return this.childDataSource.renderChart(caller, name);
    }
    addCollectionObserver(collection) {
        this.addCollectionToChildDataSource(collection);
        this.addCollection(new this.CollectionDecoratorCtor(collection, this));
    }
}
exports.default = DataSourceDecorator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YXNvdXJjZS1kZWNvcmF0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZGVjb3JhdG9ycy9kYXRhc291cmNlLWRlY29yYXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUlBLHlFQUFnRDtBQU1oRCxNQUFxQixtQkFFbkIsU0FBUSx5QkFBbUM7SUFTM0MsWUFDRSxlQUEyQixFQUMzQix1QkFBNEU7UUFFNUUsS0FBSyxFQUFFLENBQUM7UUFFUixJQUFJLENBQUMsOEJBQThCLEdBQUcsZUFBZSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDMUYsT0FBTyxDQUFDLGNBQWMsQ0FBQyxlQUFlLEVBQUUsZUFBZSxFQUFFO1lBQ3ZELEtBQUssRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztTQUM3QyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsZUFBZSxHQUFHLGVBQWUsQ0FBQztRQUN2QyxJQUFJLENBQUMsdUJBQXVCLEdBQUcsdUJBQXVCLENBQUM7UUFFdkQsSUFBSSxDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQ3BELElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxJQUFJLENBQUMsdUJBQXVCLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQ3ZFLENBQUM7SUFDSixDQUFDO0lBckJELElBQWEsTUFBTTtRQUNqQixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDO0lBQ3JDLENBQUM7SUFxQlEsV0FBVyxDQUFDLE1BQWMsRUFBRSxJQUFZO1FBQy9DLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFFTyxxQkFBcUIsQ0FBQyxVQUFzQjtRQUNsRCxJQUFJLENBQUMsOEJBQThCLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDaEQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUN6RSxDQUFDO0NBQ0Y7QUF0Q0Qsc0NBc0NDIn0=