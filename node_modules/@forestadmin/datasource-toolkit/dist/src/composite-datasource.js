"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const base_datasource_1 = __importDefault(require("./base-datasource"));
class CompositeDatasource extends base_datasource_1.default {
    constructor() {
        super();
        this.datasourceChartMapping = {};
    }
    addDataSource(dataSource) {
        this.addCollections(dataSource);
        this.addCharts(dataSource);
        return this;
    }
    get schema() {
        return { charts: Object.keys(this.datasourceChartMapping) };
    }
    renderChart(caller, name) {
        if (!this.datasourceChartMapping[name]) {
            throw new Error(`Chart '${name}' is not defined in the dataSource.`);
        }
        return this.datasourceChartMapping[name].renderChart(caller, name);
    }
    addCollections(dataSource) {
        for (const collection of dataSource.collections) {
            this.addCollection(collection);
        }
    }
    addCharts(dataSource) {
        for (const chartName of dataSource.schema.charts) {
            if (this.datasourceChartMapping[chartName]) {
                throw new Error(`Chart '${chartName}' is already defined in datasource.`);
            }
            this.datasourceChartMapping[chartName] = dataSource;
        }
    }
}
exports.default = CompositeDatasource;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9zaXRlLWRhdGFzb3VyY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY29tcG9zaXRlLWRhdGFzb3VyY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFJQSx3RUFBK0M7QUFFL0MsTUFBcUIsbUJBRW5CLFNBQVEseUJBQWlCO0lBR3pCO1FBQ0UsS0FBSyxFQUFFLENBQUM7UUFDUixJQUFJLENBQUMsc0JBQXNCLEdBQUcsRUFBRSxDQUFDO0lBQ25DLENBQUM7SUFFRCxhQUFhLENBQUMsVUFBc0I7UUFDbEMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoQyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBRTNCLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELElBQWEsTUFBTTtRQUNqQixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLEVBQUUsQ0FBQztJQUM5RCxDQUFDO0lBRVEsV0FBVyxDQUFDLE1BQWMsRUFBRSxJQUFZO1FBQy9DLElBQUksQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDdEMsTUFBTSxJQUFJLEtBQUssQ0FBQyxVQUFVLElBQUkscUNBQXFDLENBQUMsQ0FBQztTQUN0RTtRQUVELE9BQU8sSUFBSSxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDckUsQ0FBQztJQUVPLGNBQWMsQ0FBQyxVQUFzQjtRQUMzQyxLQUFLLE1BQU0sVUFBVSxJQUFJLFVBQVUsQ0FBQyxXQUFXLEVBQUU7WUFDL0MsSUFBSSxDQUFDLGFBQWEsQ0FBQyxVQUFlLENBQUMsQ0FBQztTQUNyQztJQUNILENBQUM7SUFFTyxTQUFTLENBQUMsVUFBc0I7UUFDdEMsS0FBSyxNQUFNLFNBQVMsSUFBSSxVQUFVLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRTtZQUNoRCxJQUFJLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxTQUFTLENBQUMsRUFBRTtnQkFDMUMsTUFBTSxJQUFJLEtBQUssQ0FBQyxVQUFVLFNBQVMscUNBQXFDLENBQUMsQ0FBQzthQUMzRTtZQUVELElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxTQUFTLENBQUMsR0FBRyxVQUFVLENBQUM7U0FDckQ7SUFDSCxDQUFDO0NBQ0Y7QUE1Q0Qsc0NBNENDIn0=